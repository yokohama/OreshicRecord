# パスワードクラックあれこれ

## johnの高速化

- CUPコア数指定
- フォーマット指定
- リスト指定

```bash
john --fork=14 --format=mysql-sha1 --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
```

## ハッシュ値のタイプを調べる

```bash

# hashcatのフォーマット判別
cat hash.txt | hashid -m

# Johnのフォーマット判別
cat hash.txt | hashid -j
```

## よく使う辞書ファイル

- gobusterでのディレクトリ検索

```
/usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
```

- fuffなどのサブドメイン検索

- 拡張子

```
/usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-extensions.txt
```

## ssh秘密キーのパスフレーズのクラック

- 取得した秘密キーをjohnが読めるようにフォーマット

```
ssh2john id_rsa > forjohn.txt
```

- 辞書ファイルを使ってパスフレーズを解析

```
john forjohn.txt --wordlist=rockyou.txt
```

- メモ
  - パスフレーズは秘密鍵の中に入っているわけではない。どこにも保存されていない。
  - パスフレーズを利用し秘密鍵をハッシュ化したものを秘密鍵に保存している。（端折っているが本当はここにテンポラリーな暗号鍵が制せされる)
  - johnは辞書のパスフレーズをブルートフォースしている。

## /etc/shaddowのクラック 

- サンプル

```
root:$6$Tb/euwmK$OXA.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0
```

- 以下の部分を取り出す

```
$6$Tb/euwmK$OXA.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0
```

```
echo $6$Tb/euwmK$OXA.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0 > shadow.txt

cat shadow.txt | hashid -j
[+] SHA-512 Crypt [JtR Format: sha512crypt]

john --fork=14 --format=sha512crypt --wordlist=/usr/share/wordlists/rockyou.txt shadow.txt
```


